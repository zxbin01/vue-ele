(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80515714"],{"0e14":function(t,s,e){},"0e5b":function(t,s,e){"use strict";var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"rating-select"},[e("div",{staticClass:"rating-type border-1px"},[e("span",{staticClass:"block positive",class:{active:2===t.selectType},on:{click:function(s){return t.setSelectType(2,s)}}},[t._v(" "+t._s(t.desc.all)+" "),e("span",{staticClass:"count"},[t._v(t._s(t.ratings.length))])]),e("span",{staticClass:"block positive",class:{active:0===t.selectType},on:{click:function(s){return t.setSelectType(0,s)}}},[t._v(" "+t._s(t.desc.positive)+" "),e("span",{staticClass:"count"},[t._v(t._s(t.positiveLength))])]),e("span",{staticClass:"block negative",class:{active:1===t.selectType},on:{click:function(s){return t.setSelectType(1,s)}}},[t._v(" "+t._s(t.desc.negative)+" "),e("span",{staticClass:"count"},[t._v(t._s(t.ratings.length-t.positiveLength))])])]),e("div",{staticClass:"switch",class:{on:t.onlyContent},on:{click:t.switchOnlyContent}},[e("span",{staticClass:"icon-check_circle"}),e("span",{staticClass:"text"},[t._v("只看有内容的评价")])])])},i=[],n=(e("13d5"),e("a9e3"),{props:{desc:Object,onlyContent:Boolean,ratings:Array,selectType:Number},computed:{positiveLength:function(){return this.ratings.reduce((function(t,s){return t+(0===s.rateType?1:0)}),0)}},methods:{setSelectType:function(t,s){s._constructed&&this.$emit("setselecttype",t)},switchOnlyContent:function(t){t._constructed&&this.$emit("switchonlycontent")}}}),a=n,c=(e("c069"),e("2877")),r=Object(c["a"])(a,o,i,!1,null,"5f7a12a4",null);s["a"]=r.exports},"13d5":function(t,s,e){"use strict";var o=e("23e7"),i=e("d58f").left,n=e("b301");o({target:"Array",proto:!0,forced:n("reduce")},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"159b":function(t,s,e){var o=e("da84"),i=e("fdbc"),n=e("17c2"),a=e("9112");for(var c in i){var r=o[c],l=r&&r.prototype;if(l&&l.forEach!==n)try{a(l,"forEach",n)}catch(u){l.forEach=n}}},"17c2":function(t,s,e){"use strict";var o=e("b727").forEach,i=e("b301");t.exports=i("forEach")?function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1dde":function(t,s,e){var o=e("d039"),i=e("b622"),n=e("60ae"),a=i("species");t.exports=function(t){return n>=51||!o((function(){var s=[],e=s.constructor={};return e[a]=function(){return{foo:1}},1!==s[t](Boolean).foo}))}},2240:function(t,s,e){},"224a":function(t,s,e){},"2b02":function(t,s,e){"use strict";var o=e("60ed"),i=e.n(o);i.a},"3e39":function(t,s,e){"use strict";var o=e("224a"),i=e.n(o);i.a},4160:function(t,s,e){"use strict";var o=e("23e7"),i=e("17c2");o({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"4de4":function(t,s,e){"use strict";var o=e("23e7"),i=e("b727").filter,n=e("1dde");o({target:"Array",proto:!0,forced:!n("filter")},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"58b2":function(t,s,e){"use strict";e.r(s);var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"goods"},[e("div",{ref:"menuWrapper",staticClass:"menu-wrapper"},[e("ul",t._l(t.goods,(function(s,o){return e("li",{key:o,staticClass:"menu-item",class:{current:t.currentIndex===o},on:{click:function(s){return t.clickMenuItem(o,s)}}},[e("span",{staticClass:"text border-1px"},[s.type>0?e("span",{staticClass:"icon",class:t.classMap[s.type]}):t._e(),t._v(" "+t._s(s.name)+" ")])])})),0)]),e("div",{ref:"foodsWrapper",staticClass:"foods-wrapper"},[e("ul",t._l(t.goods,(function(s,o){return e("li",{key:o,staticClass:"food-list food-list-hook"},[e("h1",{staticClass:"title"},[t._v(t._s(s.name))]),e("ul",t._l(s.foods,(function(s,o){return e("li",{key:o,staticClass:"food-item border-1px",on:{click:function(e){return t.selectFood(s,e)}}},[e("div",{staticClass:"icon"},[e("img",{staticStyle:{width:"3.5625rem",height:"3.5625rem"},attrs:{src:s.icon}})]),e("div",{staticClass:"content"},[e("h2",{staticClass:"name"},[t._v(t._s(s.name))]),e("p",{staticClass:"desc"},[t._v(t._s(s.description))]),e("div",{staticClass:"extra"},[e("span",{staticClass:"count"},[t._v("月售"+t._s(s.sellCount)+"份")]),e("span",[t._v("好评率"+t._s(s.rating)+"%")])]),e("div",{staticClass:"price"},[e("span",{staticClass:"now"},[t._v("￥"+t._s(s.price))]),e("span",{directives:[{name:"show",rawName:"v-show",value:s.oldPrice,expression:"food.oldPrice"}],staticClass:"old"},[t._v("￥"+t._s(s.oldPrice))])]),e("div",{staticClass:"cartcontrol-wrapper"},[e("cart-control",{attrs:{food:s,"update-food-count":t.updateFoodCount}})],1)])])})),0)])})),0)]),e("shop-cart",{ref:"shopcart",attrs:{"food-list":t.foodList,"min-price":t.seller.minPrice,"delivery-price":t.seller.deliveryPrice,"update-food-count":t.updateFoodCount},on:{clear:t.clearCart}})],1),e("food",{ref:"food",attrs:{food:t.selectedFood,"update-food-count":t.updateFoodCount}})],1)},i=[],n=(e("c740"),e("4160"),e("159b"),e("1fba")),a=e("bc3a"),c=e.n(a),r=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"cart-control"},[e("transition",{attrs:{name:"move"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.food.count,expression:"food.count"}],staticClass:"cart-decrease icon-remove_circle_outline",on:{click:function(s){return s.stopPropagation(),t.updateFoodCount(t.food,!1,s)}}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.food.count,expression:"food.count"}],staticClass:"cart-count"},[t._v(t._s(t.food.count))]),e("div",{staticClass:"cart-add icon-add_circle",on:{click:function(s){return s.stopPropagation(),t.updateFoodCount(t.food,!0,s)}}})],1)},l=[],u={props:{food:Object,updateFoodCount:Function}},d=u,f=(e("2b02"),e("2877")),h=Object(f["a"])(d,r,l,!1,null,"680c9a98",null),p=h.exports,v=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"shop-cart"},[e("div",{staticClass:"content"},[e("div",{staticClass:"content-left",on:{click:t.toggleList}},[e("div",{staticClass:"logo-wrapper"},[e("div",{staticClass:"logo",class:{highlight:t.foodList.length}},[e("i",{staticClass:"icon-shopping_cart",class:{highlight:t.foodList.length}})]),t.totalCount?e("div",{staticClass:"num"},[t._v(t._s(t.totalCount))]):t._e()]),e("div",{staticClass:"price",class:{highlight:t.foodList.length}},[t._v("￥"+t._s(t.totalPrice))]),e("div",{staticClass:"desc"},[t._v("另需配送费￥"+t._s(t.deliveryPrice)+"元")])]),e("div",{staticClass:"content-right",on:{click:t.pay}},[e("div",{staticClass:"pay",class:t.payClass},[t._v(t._s(t.payText))])])]),e("div",{staticClass:"ball-container"}),e("transition",{attrs:{name:"fold"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],staticClass:"shopcart-list"},[e("div",{staticClass:"list-header"},[e("h1",{staticClass:"title"},[t._v("购物车")]),e("span",{staticClass:"empty",on:{click:t.clear}},[t._v("清空")])]),e("div",{ref:"listContent",staticClass:"list-content"},[e("ul",t._l(t.foodList,(function(s,o){return e("li",{key:o,staticClass:"food"},[e("span",{staticClass:"name"},[t._v(t._s(s.name))]),e("div",{staticClass:"price"},[e("span",[t._v("￥"+t._s(s.price))])]),e("div",{staticClass:"cartcontrol-wrapper"},[e("cart-control",{attrs:{food:s,"update-food-count":t.updateFoodCount}})],1)])})),0)])])])],1),e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],staticClass:"list-mask",on:{click:t.toggleList}})])],1)},C=[],m=(e("a9e3"),{data:function(){return{isShow:!1}},components:{cartControl:p},props:{foodList:Array,minPrice:Number,deliveryPrice:Number,updateFoodCount:Function},computed:{totalCount:function(){var t=0;return this.foodList.forEach((function(s){t+=s.count})),t},totalPrice:function(){var t=0;return this.foodList.forEach((function(s){t+=s.count*s.price})),t},payText:function(){return 0===this.totalCount?"￥".concat(this.minPrice,"元起送"):this.totalPrice<this.minPrice?"还差￥".concat(this.minPrice-this.totalPrice,"元起送"):"去结算"},payClass:function(){return this.totalPrice<this.minPrice?"not-enough":"enough"},listShow:function(){var t=this;return 0===this.foodList.length?(this.isShow=!1,!1):(this.isShow&&this.$nextTick((function(){t.scroll?t.scroll.refresh():t.scroll=new n["a"](t.$refs.listContent,{click:!0})})),this.isShow)}},methods:{toggleList:function(){this.foodList.length&&(this.isShow=!this.isShow)},clear:function(){confirm("确定清空购物车吗？")&&this.$emit("clear",this.foodList)},pay:function(){this.totalPrice-this.minPrice>=0&&alert("支付".concat(this.totalPrice+this.deliveryPrice))}}}),_=m,g=(e("bd15"),Object(f["a"])(_,v,C,!1,null,"3d30cd52",null)),y=g.exports,w=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("transition",{attrs:{name:"move"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],ref:"food",staticClass:"food"},[e("div",{staticClass:"food-content"},[e("div",{staticClass:"image-header"},[e("img",{attrs:{src:t.food.image}}),e("div",{staticClass:"back",on:{click:function(s){return t.showOrHide(!1)}}},[e("i",{staticClass:"icon-arrow_lift"})])]),e("div",{staticClass:"content"},[e("h1",{staticClass:"title"},[t._v(t._s(t.food.name))]),e("div",{staticClass:"detail"},[e("span",{staticClass:"sell-count"},[t._v("月售"+t._s(t.food.sellCount)+"份")]),e("span",{staticClass:"rating"},[t._v("好评率"+t._s(t.food.rating)+"%")])]),e("div",{staticClass:"price"},[e("span",{staticClass:"now"},[t._v("￥"+t._s(t.food.price))]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.food.oldPrice,expression:"food.oldPrice"}],staticClass:"old"},[t._v("￥"+t._s(t.food.oldPrice))])]),e("div",{staticClass:"cartcontrol-wrapper"},[e("cart-control",{attrs:{food:t.food,"update-food-count":t.updateFoodCount}})],1),t.food.count?t._e():e("div",{staticClass:"buy",on:{click:function(s){return t.updateFoodCount(t.food,!0,s)}}},[t._v("加入购物车")])]),e("split"),e("div",{staticClass:"info"},[e("h1",{staticClass:"title"},[t._v("商品信息")]),e("p",{staticClass:"text"},[t._v(t._s(t.food.info))])]),e("split"),e("div",{staticClass:"rating"},[e("h1",{staticClass:"title"},[t._v("商品评价")]),t.food.ratings?e("rating-select",{attrs:{desc:t.desc,"only-content":t.onlyContent,ratings:t.food.ratings,"select-type":t.selectType},on:{switchonlycontent:t.switchOnlyContent,setselecttype:t.setSelectType}}):t._e(),e("div",{staticClass:"rating-wrapper"},[e("ul",t._l(t.filterRatings,(function(s,o){return e("li",{key:o,staticClass:"rating-item border-1px"},[e("div",{staticClass:"user"},[e("span",{staticClass:"name"},[t._v(t._s(s.username))]),e("img",{staticClass:"avatar",staticStyle:{width:"0.75rem",height:"0.75rem"},attrs:{src:s.avatar}})]),e("div",{staticClass:"time"},[t._v(t._s(s.rateTime))]),e("p",{staticClass:"text"},[e("span",{class:{"icon-thumb_up":0==s.rateType,"icon-thumb_down":1==s.rateType}}),t._v(" "+t._s(s.text)+" ")])])})),0),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.food.ratings||0===t.food.ratings.length,expression:"!food.ratings || food.ratings.length === 0"}],staticClass:"no-rating"},[t._v("暂无评价")])])],1)],1)])])},b=[],S=(e("4de4"),e("0e5b")),x=e("dda2"),k=2,L={data:function(){return{isShow:!1,onlyContent:!1,selectType:k}},props:{food:Object,updateFoodCount:Function},created:function(){this.desc={all:"全部",positive:"推荐",negative:"吐槽"}},methods:{showOrHide:function(t){var s=this;this.isShow=t,this.isShow&&this.$nextTick((function(){s.scroll?s.scroll.refresh():s.scroll=new n["a"](s.$refs.food,{click:!0})}))},switchOnlyContent:function(){var t=this;this.onlyContent=!this.onlyContent,this.$nextTick((function(){t.scroll.refresh()}))},setSelectType:function(t){var s=this;this.selectType=t,this.$nextTick((function(){s.scroll.refresh()}))}},computed:{filterRatings:function(){if(!this.food.ratings)return[];var t=this.food.ratings,s=this.selectType,e=this.onlyContent;return t.filter((function(t){var o=t.rateType,i=t.text;return 2===s?!e||i.length>0:s===o&&(!e||i.length>0)}))}},components:{ratingSelect:S["a"],cartControl:p,split:x["a"]}},T=L,P=(e("3e39"),Object(f["a"])(T,w,b,!1,null,"0f5b0614",null)),E=P.exports,F={data:function(){return{goods:[],tops:[],scrollY:0,selectedFood:{}}},props:{seller:Object},components:{cartControl:p,shopCart:y,food:E},created:function(){var t=this;this.classMap=["decrease","discount","special","invoice","guarantee"],c()({url:"/api2/goods"}).then((function(s){0===s.data.code&&(t.goods=s.data.data,t.$nextTick((function(){t._initScroll(),t._initTops()})))}))},methods:{_initScroll:function(){var t=this;this.menuScroll=new n["a"](this.$refs.menuWrapper,{click:!0}),this.foodsScroll=new n["a"](this.$refs.foodsWrapper,{click:!0,probeType:3}),this.foodsScroll.on("scroll",(function(s){t.scrollY=Math.abs(Math.round(s.y))}))},_initTops:function(){var t=this.$refs.foodsWrapper.getElementsByClassName("food-list-hook"),s=0;this.tops.push(s);for(var e=0;e<t.length;e++){var o=t[e];s+=o.clientHeight,this.tops.push(s)}console.log(this.tops)},clickMenuItem:function(t,s){if(s._constructed){var e=this.$refs.foodsWrapper.getElementsByClassName("food-list-hook"),o=e[t];this.foodsScroll.scrollToElement(o,300)}},updateFoodCount:function(t,s,e){e._constructed&&(s?t.count?t.count++:this.$set(t,"count",1):t.count&&t.count--)},clearCart:function(){this.foodList.forEach((function(t){t.count=0}))},selectFood:function(t,s){s._constructed&&(this.selectedFood=t,this.$refs.food.showOrHide(!0))}},computed:{currentIndex:function(){var t=this;return this.tops.findIndex((function(s,e){return t.scrollY>=s&&t.scrollY<t.tops[e+1]}))},foodList:function(){var t=[];return this.goods.forEach((function(s){s.foods.forEach((function(s){s.count&&t.push(s)}))})),t}}},$=F,O=(e("d756"),Object(f["a"])($,o,i,!1,null,"a8cefdb0",null));s["default"]=O.exports},"60ed":function(t,s,e){},"65f0":function(t,s,e){var o=e("861d"),i=e("e8b5"),n=e("b622"),a=n("species");t.exports=function(t,s){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)?o(e)&&(e=e[a],null===e&&(e=void 0)):e=void 0),new(void 0===e?Array:e)(0===s?0:s)}},"8db6":function(t,s,e){},b301:function(t,s,e){"use strict";var o=e("d039");t.exports=function(t,s){var e=[][t];return!e||!o((function(){e.call(null,s||function(){throw 1},1)}))}},b727:function(t,s,e){var o=e("f8c2"),i=e("44ad"),n=e("7b0b"),a=e("50c4"),c=e("65f0"),r=[].push,l=function(t){var s=1==t,e=2==t,l=3==t,u=4==t,d=6==t,f=5==t||d;return function(h,p,v,C){for(var m,_,g=n(h),y=i(g),w=o(p,v,3),b=a(y.length),S=0,x=C||c,k=s?x(h,b):e?x(h,0):void 0;b>S;S++)if((f||S in y)&&(m=y[S],_=w(m,S,g),t))if(s)k[S]=_;else if(_)switch(t){case 3:return!0;case 5:return m;case 6:return S;case 2:r.call(k,m)}else if(u)return!1;return d?-1:l||u?u:k}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},bd15:function(t,s,e){"use strict";var o=e("0e14"),i=e.n(o);i.a},c069:function(t,s,e){"use strict";var o=e("8db6"),i=e.n(o);i.a},c740:function(t,s,e){"use strict";var o=e("23e7"),i=e("b727").findIndex,n=e("44d2"),a="findIndex",c=!0;a in[]&&Array(1)[a]((function(){c=!1})),o({target:"Array",proto:!0,forced:c},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(a)},d58f:function(t,s,e){var o=e("1c0b"),i=e("7b0b"),n=e("44ad"),a=e("50c4"),c=function(t){return function(s,e,c,r){o(e);var l=i(s),u=n(l),d=a(l.length),f=t?d-1:0,h=t?-1:1;if(c<2)while(1){if(f in u){r=u[f],f+=h;break}if(f+=h,t?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;t?f>=0:d>f;f+=h)f in u&&(r=e(r,u[f],f,l));return r}};t.exports={left:c(!1),right:c(!0)}},d756:function(t,s,e){"use strict";var o=e("2240"),i=e.n(o);i.a},e8b5:function(t,s,e){var o=e("c6b6");t.exports=Array.isArray||function(t){return"Array"==o(t)}},fdbc:function(t,s){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-80515714.7c09b388.js.map